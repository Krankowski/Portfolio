(function(define){var __define;"function"==typeof define&&define.amd&&(__define=define,define=null);
!function(){function e(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}var t=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire1d24;t.register("5Z4wZ",(function(n,r){e(n.exports,"migrateToMultichainSilentlyIfNeeded",(function(){return u}),(function(e){return u=e}));var i=t("4xbAj"),o=t("8ZF3Y"),c=t("7kE51"),a=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function c(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,a)}l((r=r.apply(e,t||[])).next())}))};const l=new Error("Migration could not be completed to full multi-chain mode."),u=e=>a(void 0,void 0,void 0,(function*(){try{if(yield(0,c.isMultiChainEnabled)())return"no-migration";switch(yield(0,o.migrateIfNeededAndEnableMultichain)(e)){case o.MigrationAttemptResult.Completed:return"success";case o.MigrationAttemptResult.HasAlreadyBeenCompleted:return"no-migration";case o.MigrationAttemptResult.CouldNotStart:case o.MigrationAttemptResult.Failed:return"failure"}}catch(e){return(0,i.logMigrationError)(e,i.MigrationStep.Migration,(e=>e===l?"extension silent migration to full multi-chain mode":"extension silent migration unknown error")(e)),"failure"}}))})),t.register("8ZF3Y",(function(n,r){e(n.exports,"MigrationAttemptResult",(function(){return i}),(function(e){return i=e})),e(n.exports,"migrateIfNeededAndEnableMultichain",(function(){return s}),(function(e){return s=e}));var i,o,c=t("41yT6"),a=t("9KHVf"),l=t("h1hWw"),u=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function c(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,a)}l((r=r.apply(e,t||[])).next())}))};(o=i||(i={})).HasAlreadyBeenCompleted="hasAlreadyBeenCompleted",o.CouldNotStart="couldNotStart",o.Completed="completed",o.Failed="failed";const s=e=>u(void 0,void 0,void 0,(function*(){const t=yield d(e,!0);return t===i.Completed&&(yield(0,l.setMultichainGTMEnabledOverride)(),yield c.queryClient.invalidateQueries({refetchType:"all"})),t})),d=(e,t)=>u(void 0,void 0,void 0,(function*(){if(yield e.hasCompletedMigration())return i.HasAlreadyBeenCompleted;const n=yield e.canStartMigration();if(!1===n.result)return a.migrationAnalytics.onCanStartMigrationResult(n),i.CouldNotStart;a.migrationAnalytics.onMigrationStarted();const r=yield e.migrate();return r&&(yield e.cleanup()),a.migrationAnalytics.onMigrationSettled(t,r),r?i.Completed:i.Failed}))})),t.register("h1hWw",(function(n,r){e(n.exports,"setMultichainGTMEnabledOverride",(function(){return u}),(function(e){return u=e}));var i=t("goVRJ"),o=t("twk6W"),c=t("6zJYJ"),a=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function c(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,a)}l((r=r.apply(e,t||[])).next())}))};const l=new(0,i.LegacyIndexedDBProxy),u=()=>a(void 0,void 0,void 0,(function*(){yield l.set(c.multichainEnabledOverrideStorageKey,{version:2,forceMultichainEnabled:!0,multiChainGTMEnabled:!0}),yield o.analytics.capture("migrationMultichainSetGTMOverride")}))})),t.register("3FEtE",(function(n,r){e(n.exports,"createWalletScreenHooks",(function(){return t("2kZOi").createWalletScreenHooks})),e(n.exports,"WALLET_SCREEN_ACTION_QUERY_KEY",(function(){return t("3dcvy").WALLET_SCREEN_ACTION_QUERY_KEY})),e(n.exports,"WalletScreenError",(function(){return t("7NAht").WalletScreenError})),e(n.exports,"WalletScreenSurface",(function(){return t("7NAht").WalletScreenSurface}));t("2kZOi"),t("3dcvy"),t("7NAht")})),t.register("2kZOi",(function(n,r){e(n.exports,"createWalletScreenHooks",(function(){return o}));var i=t("9PVjP");function o(e,t){return{useThrowIfFailWalletScreen:(n,r)=>(0,i.useThrowIfFailWalletScreen)(e,t,n,r)}}})),t.register("9PVjP",(function(n,r){e(n.exports,"useThrowIfFailWalletScreen",(function(){return l}));var i=t("iOvk1"),o=t("29o0l"),c=t("7NAht"),a=t("78mXH");const l=(e,t,n,r)=>{const{data:l}=(0,a.useWalletScreenAction)(e,n);switch((0,o.useEffect)((()=>{l&&n&&t.capture("walletScreened",{data:{walletScreen:{action:l.toString(),surface:r},chainId:i.Chains.getChainID(n.networkID),networkId:n.networkID}})}),[l,n,r,t]),l){case c.WalletScreenAction.FAIL_SEVERE:case c.WalletScreenAction.FAIL_HIGH:throw new(0,c.WalletScreenError)(`Transaction disabled: ${r}`);case c.WalletScreenAction.NO_ACTION:case c.WalletScreenAction.DATA_NOT_FOUND:return}}})),t.register("7NAht",(function(n,r){e(n.exports,"WalletScreenAction",(function(){return i})),e(n.exports,"WalletScreenResponse",(function(){return u})),e(n.exports,"WalletScreenError",(function(){return s})),e(n.exports,"WalletScreenSurface",(function(){return d}));var i,o,c=t("iOvk1"),a=t("7XqVB");(o=i||(i={})).FAIL_SEVERE="FAIL_SEVERE",o.FAIL_HIGH="FAIL_HIGH",o.NO_ACTION="NO_ACTION",o.DATA_NOT_FOUND="DATA_NOT_FOUND";const l=a.z.object({action:a.z.nativeEnum(i),address:c.Caip19Address,expirationUnixtimeInSec:a.z.number().nullable()}),u=a.z.object({addressScreenResults:a.z.array(l)});class s extends Error{constructor(e){super(e),this.name="WalletScreenError"}}var d,f;(f=d||(d={})).BURN_COLLECTIBLE="BURN_COLLECTIBLE",f.CREATE_LISTING="CREATE_LISTING",f.EDIT_LISTING="EDIT_LISTING",f.REMOVE_LISTING="REMOVE_LISTING",f.SEND_COLLECTIBLE="SEND_COLLECTIBLE",f.SEND_FUNGIBLE="SEND_FUNGIBLE",f.STAKE_FUNGIBLE="STAKE_FUNGIBLE",f.SWAP_FUNGIBLE="SWAP_FUNGIBLE",f.INSTANT_SELL="INSTANT_SELL"})),t.register("78mXH",(function(n,r){e(n.exports,"useWalletScreenAction",(function(){return A}),(function(e){return A=e}));var i=t("iOvk1"),o=t("3ljHn"),c=t("RVqnc"),a=t("5ekp2"),l=t("7dHjq"),u=t("29o0l"),s=t("3dcvy"),d=t("7NAht"),f=t("erVxP"),E=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function c(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,a)}l((r=r.apply(e,t||[])).next())}))};const S=(0,c.toMilliseconds)({days:7}),A=(e,t)=>{const n=(0,u.useMemo)((()=>o.featureFlagClient.isFeatureEnabled("wallet-screening-2")),[]),r=void 0!==t&&n;let c=[];if(void 0!==t){const e=i.Chains.isEVMNetworkID(t.networkID)?t.address.toLowerCase():t.address;c=[{chainId:t.networkID,address:e,resourceType:i.Caip19ResourceType.address}]}const A={addresses:c},p=(0,l.useQueryClient)(),I=s.walletScreenQueryKeys.walletScreenAction(A,n),N=[I[0]];return(0,a.useQuery)({enabled:r,queryKey:I,cacheTime:S,staleTime:S,refetchInterval:!1,refetchOnMount:!1,queryFn(){return E(this,void 0,void 0,(function*(){if(h(p,N))return d.WalletScreenAction.FAIL_SEVERE;const t=yield(0,f.fetchWalletScreenAction)(e(),A);return y(t)}))}})},h=(e,t)=>{const n=e.getQueriesData({queryKey:t,exact:!1});let r=!1;for(const[e,t]of n){if(t&&t===d.WalletScreenAction.FAIL_SEVERE){r=!0;break}}return r},y=e=>{const t=e.addressScreenResults;return t.some((e=>e.action===d.WalletScreenAction.FAIL_SEVERE))?d.WalletScreenAction.FAIL_SEVERE:t.some((e=>e.action===d.WalletScreenAction.FAIL_HIGH))?d.WalletScreenAction.FAIL_HIGH:t.some((e=>e.action===d.WalletScreenAction.NO_ACTION))?d.WalletScreenAction.NO_ACTION:d.WalletScreenAction.DATA_NOT_FOUND}})),t.register("3dcvy",(function(t,n){e(t.exports,"WALLET_SCREEN_ACTION_QUERY_KEY",(function(){return r})),e(t.exports,"walletScreenQueryKeys",(function(){return i}));const r="@phantom-labs/wallet-screening:wallet-screen-action",i={walletScreenAction:(e,t)=>[r,e,t]}})),t.register("erVxP",(function(n,r){e(n.exports,"fetchWalletScreenAction",(function(){return a}),(function(e){return a=e}));var i=t("7NAht"),o=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function c(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,a)}l((r=r.apply(e,t||[])).next())}))};const c=new Error("Failed to fetch wallet screen action.");function a(e,t){return o(this,void 0,void 0,(function*(){try{const n=yield fetch(`${e}/wallet_screen/v1`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(t)});if(!n.ok)throw c;const r=yield n.json();return i.WalletScreenResponse.parse(r)}catch(e){throw c}}))}}))}();
//# sourceMappingURL=migrateToMultichainSilently.f1b9ad56.js.map
define=__define;})(window.define);